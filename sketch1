let video;
let captureButton;
let avgColor = [255, 255, 255]; // Default white
let analyzing = false;

function setup() {
  createCanvas(windowWidth, windowHeight);

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.11.1/p5.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.11.1/addons/p5.sound.min.js"></script>
    <link rel="stylesheet" type="text/css" href="style.css">
    <meta charset="utf-8" />

  </head>
  <body>
    <main>
    </main>
    <script src="sketch.js"></script>
  </body>
</html>
  captureButton = createButton("Capture Image");
  captureButton.position(285, 57);
  captureButton.mousePressed(getAverageColor);
}

function draw() {
  if (analyzing) {
    background(avgColor);
  } else {
    image(video, 0, 0, width, height);
  }
}

function getAverageColor() {
  video.loadPixels();

  if (video.pixels.length > 0) {
    let r = 0, g = 0, b = 0, count = 0;

    for (let y = 0; y < video.height; y++) {
      for (let x = 0; x < video.width; x++) {
        let index = (x + y * video.width) * 4;
        r += video.pixels[index];
        g += video.pixels[index + 1];
        b += video.pixels[index + 2];
        count++;
      }
    }

    avgColor = [r / count, g / count, b / count];
    analyzing = true;

  
    if (typeof firebase !== "undefined" && db) {
      saveColorToFirebase(avgColor);
    } else {
      console.error("Firebase is not initialized!");
    }
  }
}

function saveColorToFirebase(color) {
  db.collection("colors").add({
    r: color[0],
    g: color[1],
    b: color[2],
    timestamp: firebase.firestore.FieldValue.serverTimestamp()
  })
  .then(docRef => console.log("Document written with ID:", docRef.id))
  .catch(error => console.error("Error adding document:", error));
}

